#Main Code for the Fourier Transform of Pulsar Data Project
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

def compute_fourier(x_data, N_total, sample_interval=0.004):
    """
    Compute the Fourier transform of the given data using the method from project notes. Note outputs arrays of frequencies and power as well as A_k and B_k.
    """

    # Initialize arrays
    A_k = np.zeros(N_total)
    B_k = np.zeros(N_total)
    power = np.zeros(N_total)


    # Computes for all k values
    for k in range(1, N_total):
        #Sets the angle theta and initializes U_n
        theta = 2 * np.pi * k / N_total
        cos_theta = np.cos(theta)
        sin_theta = np.sin(theta)

        U_n = np.zeros(N_total + 2)


        #generates the current U_n value
        for current_n in range(N_total - 1, -1, -1):
            U_n[current_n] = x_data[current_n] + 2 * cos_theta * U_n[current_n + 1] - U_n[current_n + 2]


        #ues the U_n value and trig functions to calculate the A_k and B_k values
        A_k[k] = (U_n[0] - U_n[1] * cos_theta) / N_total
        B_k[k] = (U_n[1] * sin_theta) / N_total

        #computes the power 
        power[k] = A_k[k]**2 + B_k[k]**2
    
    return power, A_k, B_k



def load_pulsar_data(filepath="PULSAR.DAT"):
    """Load the pulsar data from the ASCII file."""
    try:
        data = np.loadtxt(filepath)
        return data
    except Exception as e:
        print(f"Error loading data: {e}")
        # Create synthetic data if file not found for testing
        return np.zeros(256)
    
def load_data(filename):
    """ Loads the file into python. Note you must put the file in the same directory as this code and run from this directory not as root. """
    data = pd.read_csv(filename, delim_whitespace=True, header=None)
    return data


